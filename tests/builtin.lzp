(show "=================================")
(show "==> Testing built in functions...")
(show "=================================")

(show "This test should be run without the prelude.")
(show "The this is considerd a succes if:")
(show "     1. This script runs without crashes")
(show "     2. Finishes with exit code 0")
(show "Some errors will apear, this is part of the test.")
(show "Running...")
(show "")

(list)
(list list)
(list {} + -)
(if (== (list 1 2 3 4) {1 2 3 4}) {} {exit 101})
(if (== (list 1) {1}) {} {exit 102})
(if (== (list "foo " "bar") {"foo " "bar"}) {} {exit 103})

(head)
(head 3)
(head {})
(head "")
(head 32 32)
(if (== (head {32 2 3 4}) {32}) {} {exit 201})
(if (== (head {+ 3 - 4}) {+}) {} {exit 202})
(if (== (head {head {+ 3 - 4}}) {head}) {} {exit 203})
(if (== (head "abc") "a") {} {exit 204})
(if (== (head "q") "q") {} {exit 205})

(tail)
(tail 3)
(tail {})
(tail "")
(tail 32 32)
(if (== (tail {32 2 3 4}) {2 3 4}) {} {exit 301})
(if (== (tail {+ 3 - /}) {3 - /}) {} {exit 302})
(if (== (tail {head {+ 3 - 4}}) {{+ 3 - 4}}) {} {exit 303})
(if (== (tail "abc") "bc") {} {exit 304})
(if (== (tail "q") "") {} {exit 305})

(len)
(len 3)
(len 32 32)
(if (== (len {32 2 3 4}) 4) {} {exit 401})
(if (== (len {+ 3 - / head}) 5) {} {exit 402})
(if (== (len {head {+ 3 - 4}}) 2) {} {exit 403})
(if (== (len {}) 0) {} {exit 404})
(if (== (len "") 0) {} {exit 405})
(if (== (len "teehee") 6) {} {exit 406})
(if (== (len "aa") 2) {} {exit 407})
(if (== (len "b") 1) {} {exit 408})

(join)
(join + 32 ())
(join {5} "t")
(join "" {5})
(if (== (join {a} {b}) {a b}) {} {exit 501})
(if (== (join {1 2 4} {9}) {1 2 4 9}) {} {exit 502})
(if (== (join {}) {}) {} {exit 503})
(if (== (join {} {} {}) {}) {} {exit 504})
(if (== (join "test " "1") "test 1") {} {exit 505})
(if (== (join "test " "1" "3") "test 13") {} {exit 506})
(if (== (join "te") "te") {} {exit 507})
(if (== (join "te" "" "") "te") {} {exit 508})

(eval)
(eval + 2 4)
(eval 3)
(eval ())
(eval +)
(if (== (eval {}) ()) {} {exit 601})
(if (== (eval {join {a} {b}} {a b})) {} {exit 602})

;===================================================================

(+)
(+ {})
(+ -)
(+ 2 4.0 () 6)
(if (== (+ 2) 2) {} {exit 701})
(if (== (+ -2) -2) {} {exit 702})
(if (== (+ -2 10) 8) {} {exit 703})
(if (== (+ 1 2 3 5) 11) {} {exit 704})
(if (== (+ 1 2 3 5 -12) -1) {} {exit 705})
(if (== (+ 1 2.1 3 5 -12) -0.9) {} {exit 706})
(if (== (+ 1 1.1) 2.1) {} {exit 707})
(if (== (+ 1.1 1) 2.1) {} {exit 708})
(if (== (+ 1.1 1.1) 2.2) {} {exit 709})
(if (== (+ -.1 .5) 0.4) {} {exit 710})

(-)
(- {})
(- -)
(- 2 4.0 () 6)
(if (== (- 2) -2) {} {exit 801})
(if (== (- -2) 2) {} {exit 802})
(if (== (- -2 10) -12) {} {exit 803})
(if (== (- 1 2 3 5) -9) {} {exit 804})
(if (== (- 5 1 2 3) -1) {} {exit 805})
(if (== (- 1 2 3 5 -12) 3) {} {exit 806})
(if (== (- 1 2.1 3 5 -12) 2.9) {} {exit 807})
(if (== (- 1 1.1) -0.1) {} {exit 808})
(if (== (- 1.1 1) .1) {} {exit 809})
(if (== (- 1.1 1.1) 0.0) {} {exit 810})
(if (== (- -.1 .5) -.6) {} {exit 811})

(*)
(* {})
(* -)
(* 2 4.0 () 6)
(if (== (* 2) 2) {} {exit 901})
(if (== (* -2) -2) {} {exit 902})
(if (== (* 2 -10) -20) {} {exit 903})
(if (== (* 1 2 3 5) 30) {} {exit 904})
(if (== (* 5 1 2 3) 30) {} {exit 905})
(if (== (* 32 234 43 35 492) 5544564480) {} {exit 906})
(if (== (* 1 2.5 3.3) 8.25) {} {exit 907})
(if (== (* 2 1.1) 2.2) {} {exit 908})
(if (== (* 1.1 3) 3.3) {} {exit 909})
(if (== (* 1.1 1.1) 1.21) {} {exit 910})
(if (== (* -.1 .5) -.05) {} {exit 911})

(/)
(/ {})
(/ -)
(/ 2 5 {} ())
(/ 32 4.0 0 3)
(if (== (/ 2) 2) {} {exit 1001})
(if (== (/ -2) -2) {} {exit 1002})
(if (== (/ 0) 0) {} {exit 1003})
(if (== (/ 10 -2) -5) {} {exit 1004})
(if (== (/ 1 2) 0) {} {exit 1005})
(if (== (/ 4 5) 0) {} {exit 1006})
(if (== (/ 1000 4 2) 125) {} {exit 1007})
(if (== (/ 2342 2 4) 292) {} {exit 1008})
(if (== (/ 5 2) 2) {} {exit 1009})
(if (== (/ 5 2.0) 2.5) {} {exit 1010})
(if (== (/ 11.2 2) 5.6) {} {exit 1011})
(if (== (/ 1.1 1.1) 1.0) {} {exit 1012})
(if (== (/ -.1 .5) -.2) {} {exit 1013})

(%)
(% {})
(% -)
(% 2 5 {} ())
(% 32 4.0 0 3)
(if (== (% 2) 2) {} {exit 1101})
(if (== (% -2) -2) {} {exit 1102})
(if (== (% 0) 0) {} {exit 1103})
(if (== (% 10 -2) 0) {} {exit 1104})
(if (== (% 1 2) 1) {} {exit 1105})
(if (== (% 4 5) 4) {} {exit 1106})
(if (== (% 1000 3 2) 1) {} {exit 1107})
(if (== (% 2342 9 11) 2) {} {exit 1108})

(**)
(** {})
(** -)
(** 2 5.7 {} ())
(if (== (** 2) 2) {} {exit 1201})
(if (== (** -2) -2) {} {exit 1202})
(if (== (** 0) 0) {} {exit 1203})
(if (== (** 10 -2) 0) {} {exit 1204})
(if (== (** 1 2) 1) {} {exit 1205})
(if (== (** 4 5) 1024) {} {exit 1206})
(if (== (** 9 3 2) 531441) {} {exit 1207})
(if (== (** 923223 0 2322) 1) {} {exit 1208})
(if (== (** 5 -2) 0) {} {exit 1209})
(if (== (** 25 .5) 5.0) {} {exit 1210})
(if (== (** 11.4 2) 129.96) {} {exit 1211})
(if (== (** 1.0 1.5) 1.0) {} {exit 1212})

(min)
(min {})
(min -)
(min 2 5.6 {} ())
(if (== (min 2) 2) {} {exit 1301})
(if (== (min -2) -2) {} {exit 1302})
(if (== (min 0) 0) {} {exit 1303})
(if (== (min 10 -2) -2) {} {exit 1304})
(if (== (min 1 2) 1) {} {exit 1305})
(if (== (min 4 5) 4) {} {exit 1306})
(if (== (min 9 -3 2 0) -3) {} {exit 1307})
(if (== (min 923223 0 2322 -1) -1) {} {exit 1308})
(if (== (min 5 -2.23) -2.23) {} {exit 1309})
(if (== (min .5 25) .5) {} {exit 1310})
(if (== (min 11.4 2) 2) {} {exit 1311})
(if (== (min 1.0 1.5) 1.0) {} {exit 1312})

(max)
(max {})
(max -)
(max 2 5.2 {} ())
(if (== (max 2) 2) {} {exit 1401})
(if (== (max -2) -2) {} {exit 1402})
(if (== (max 0) 0) {} {exit 1403})
(if (== (max 10 -2) 10) {} {exit 1404})
(if (== (max 1 2) 2) {} {exit 1405})
(if (== (max 4 5) 5) {} {exit 1406})
(if (== (max 9 -3 2 0) 9) {} {exit 1407})
(if (== (max -923223 0 2322 -1) 2322) {} {exit 1408})
(if (== (max 5 -2.23) 5) {} {exit 1409})
(if (== (max .5 25.1) 25.1) {} {exit 1410})
(if (== (max 11.4 2) 11.4) {} {exit 1411})
(if (== (max 1.0 1.5) 1.5) {} {exit 1412})

;================================================================

(>)
(> 1 ())
(> () 43)
(> - + 5 2)
(> 23 4 3)
(if (== (> 10 2) 1) {} {exit 1501})
(if (== (> 2 2) 0) {} {exit 1502})
(if (== (> -2 2) 0) {} {exit 1503})
(if (== (> 0 -32) 1) {} {exit 1504})
(if (== (> 1 0) 1) {} {exit 1505})
(if (== (> -2 2.1) 0) {} {exit 1506})
(if (== (> 2.4 -32) 1) {} {exit 1507})
(if (== (> 23.1 -.4) 1) {} {exit 1508})

(<)
(< 1 ())
(< () 43)
(< - + 5 2)
(< 23 4 3)
(if (== (< 10 2) 0) {} {exit 1601})
(if (== (< 2 2) 0) {} {exit 1602})
(if (== (< -2 2) 1) {} {exit 1603})
(if (== (< 0 -32) 0) {} {exit 1604})
(if (== (< 1 0) 0) {} {exit 1605})
(if (== (< -2 2.1) 1) {} {exit 1606})
(if (== (< 2.4 -32) 0) {} {exit 1607})
(if (== (< 23.1 -.4) 0) {} {exit 1608})

(>=)
(>= 1 ())
(>= () 43)
(>= - + 5 2)
(>= 23 4 3)
(if (== (>= 10 2) 1) {} {exit 1701})
(if (== (>= 2 2) 1) {} {exit 1702})
(if (== (>= -2 2) 0) {} {exit 1703})
(if (== (>= 0 -32) 1) {} {exit 1704})
(if (== (>= 1 0) 1) {} {exit 1705})
(if (== (>= -2 2.1) 0) {} {exit 1706})
(if (== (>= 2.4 -32) 1) {} {exit 1707})
(if (== (>= 23.1 -.4) 1) {} {exit 1708})
(if (== (>= -.4 -.4) 1) {} {exit 1709})

(<=)
(<= 1 ())
(<= () 43)
(<= - + 5 2)
(<= 23 4 3)
(if (== (<= 10 2) 0) {} {exit 1801})
(if (== (<= 2 2) 1) {} {exit 1802})
(if (== (<= -2 2) 1) {} {exit 1803})
(if (== (<= 0 -32) 0) {} {exit 1804})
(if (== (<= 1 0) 0) {} {exit 1805})
(if (== (<= -2 2.1) 1) {} {exit 1806})
(if (== (<= 2.4 -32) 0) {} {exit 1807})
(if (== (<= 23.1 -.4) 0) {} {exit 1808})
(if (== (<= -.4 -.4) 1) {} {exit 1809})

(==)
(== 3 {} 3)
(== 3)
(if (== (== {} ()) 0) {} {exit 1901})
(if (== (== 9 9) 1) {} {exit 1902})
(if (== (== 19 9) 0) {} {exit 1903})
(if (== (== < <) 1) {} {exit 1904})
(if (== (== < >) 0) {} {exit 1905})
(if (== (== "tee" "tee") 1) {} {exit 1906})
(if (== (== "tee" "hee") 0) {} {exit 1907})
(if (== (== () ()) 1) {} {exit 1907})
(if (== (== (+ 2 3) ()) 0) {} {exit 1908})
(if (== (== (+ 23) (+ 23)) 1) {} {exit 1909})
(if (== (== {+ 23} {+ 23}) 1) {} {exit 1910})
(if (== (== {+ 33} {+ 23}) 0) {} {exit 1911})
(if (== (== 0.1 .1) 1) {} {exit 1912})

(!=)
(!= 3 {} 3)
(!= 3)
(if (== (!= {} ()) 1) {} {exit 2001})
(if (== (!= 9 9) 0) {} {exit 2002})
(if (== (!= 19 9) 1) {} {exit 2003})
(if (== (!= < <) 0) {} {exit 2004})
(if (== (!= < >) 1) {} {exit 2005})
(if (== (!= "tee" "tee") 0) {} {exit 2006})
(if (== (!= "tee" "hee") 1) {} {exit 2007})
(if (== (!= () ()) 0) {} {exit 2007})
(if (== (!= (+ 2 3) ()) 1) {} {exit 2008})
(if (== (!= (+ 23) (+ 23)) 0) {} {exit 2009})
(if (== (!= {+ 23} {+ 23}) 0) {} {exit 2010})
(if (== (!= {+ 33} {+ 23}) 1) {} {exit 2011})
(if (== (!= 0.1 .1) 0) {} {exit 2012})

(!)
(! 32 34)
(! {} 34)
(! {})
(! "tee")
(if (== (! 1) 0) {} {exit 2101})
(if (== (! 0) 1) {} {exit 2102})
(if (== (! 10) 0) {} {exit 2103})
(if (== (! -10) 0) {} {exit 2104})

(||)
(|| 32 34)
(|| {} 34)
(|| {})
(|| "tee")
(if (== (|| 1 0) 1) {} {exit 2201})
(if (== (|| 0 0) 0) {} {exit 2202})
(if (== (|| 0 1) 1) {} {exit 2203})
(if (== (|| 1 1) 1) {} {exit 2204})
(if (== (|| 1 10) 1) {} {exit 2205})
(if (== (|| -1 -10) 1) {} {exit 2206})

(&&)
(&& 32 34)
(&& {} 34)
(&& {})
(&& "tee")
(if (== (&& 1 0) 0) {} {exit 2301})
(if (== (&& 0 0) 0) {} {exit 2302})
(if (== (&& 0 1) 0) {} {exit 2303})
(if (== (&& 1 1) 1) {} {exit 2304})
(if (== (&& 1 10) 1) {} {exit 2305})
(if (== (&& -1 -10) 1) {} {exit 2306})
(if (== (&& 0 -10) 0) {} {exit 2307})

(if)
(if 1 1)
(if 1 1 1 1)
(if {} {} 1)
(if 1 1 1)
(if {} {} {})
(if 1 {+ 1 1} {exit 2401})
(if 0 {exit 2402} {+ 1 1})
(if 0 {} {})
(if 1 {} {})

(str)
(str 1 1 1)
(str ())
(str {23})
(str 23)
(str 23.232)
(str show)
(str (\ {a} {+ a 1}))
(if (== (str 11) "11") {} {exit 2501})

;================================================================

(load)
(load "tee" "hee")
(load 3)
(load "non_existent_file.lzp")
(load "./tests/load_test.lzp")

(error)
(error "tee" "hee")
(error 3)
(error "Testing error builtin")

(show)
(show "tee" "hee")
(show 3)
(show "Testing show builtin")

(print)
(print 23 -45)
(print exit +)
(print "lalalala" "tee hee")
(def {x} 100)
(print x "aaa")
(print (+ 2 4))
(print {+ 2 4})

(read)
(read "a" "b")
(read 1243)
(read {+ 2 3})
(read "(+ 2 3); testing\n (show \"aaa\")")
(read "~~~")

;================================================================

(def)
(def {})
(def 3)
(def {a} 1 2)
(def {a b} 1)
(def {q} ())
(def {a} 10)
(if (== a 10) {} {exit 2501})
(def {x y} a -2)
(if (== x 10) {} {exit 2502})
(if (== y -2) {} {exit 2503})

(\)
(\ 1)
(\ 1 1 1)
(\ 1 {})
(\ {} 1)
(if (== ((\ {a b} {+ a b}) 1 2) 3) {} {exit 2601})
(if (== (((\ {a b c} {+ a b c}) 1 2) 3) 6) {} {exit 2602})

(=)
(= {})
(= 3)
(= {a} 1 2)
(= {a b} 1)
(= {a} 10)
(if (== a 10) {} {exit 2701})
(= {x y} a -2)
(if (== x 10) {} {exit 2702})
(if (== y -2) {} {exit 2703})
(= {i} -1)
(= {j} -1)
((\ {_} {def {i} 99}) ())
((\ {_} {= {j} 99}) ())
(if (== i 99) {} {exit 2704})
(if (== j -1) {} {exit 2705})

;================================================================

(state ())

(show "")
(show "DONE. Succes!")
(exit 0)